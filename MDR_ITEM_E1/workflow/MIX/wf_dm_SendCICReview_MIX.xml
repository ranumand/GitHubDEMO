<?xml version="1.0" encoding="UTF-8"?>
<Workflow xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" Version="1.3">
	<Owner>TIBCO</Owner>
	<Name>wf_dm_SendCICReview</Name>
	<Description>Reviewed either because operation type is NEW or Heirarchy is not valid</Description>
	<Parameter name="inDoc" direction="in" type="document" eval="variable">1</Parameter>
	<Parameter name="classStatus" direction="in" type="string" eval="variable">classStatus</Parameter>
	<Parameter name="message" direction="in" type="string" eval="variable">message</Parameter>
	<Parameter name="outDoc1" direction="out" type="document" eval="variable"/>
	<Parameter name="OutDocument" direction="out" type="document" eval="variable">workDoc</Parameter>
	<Parameter name="statusOfWI" direction="out" type="string" eval="variable">statusOfWI</Parameter>
	<Parameter name="errorFlag" direction="out" type="boolean" eval="variable">errorFlag</Parameter>
	<Parameter name="Environment_Name4" direction="in" type="string" eval="variable">Environment_Name3</Parameter>
	<Parameter name="HierarchyRolesStatus" direction="in" type="string" eval="variable"/>
	<Parameter name="updateHierarchyRolesBln" direction="in" type="boolean" eval="variable"/>
	<Parameter name="ItemMasterRecordState" direction="in" type="string" eval="variable"/>
	<!--CIM Activities-->
	<Activity Name="AddMsgInfoToAddRecord">
		<Start/>
		<Action>UpdateEvent</Action>
		<Description>Set the event state</Description>
		<Execution>SYNCHR</Execution>
		<Parameter name="eventDescriptor" direction="in" type="string" eval="xpath" source="/Message/Body/Document/@subtype">inDoc</Parameter>
		<Parameter name="deploymentMode" direction="in" type="string" eval="xpath" source="/Message/@messageType">inDoc</Parameter>
		<Parameter name="eventState" direction="in" type="string" eval="constant">Approve or CIC Review</Parameter>
		<Parameter name="eventType" direction="in" type="string" eval="constant">CAT</Parameter>
		<Parameter name="message1" direction="in" type="string" eval="variable">message</Parameter>
		<Parameter name="CICCode" direction="in" type="string" eval="xpath" source="/Message/Body/Document/BusinessDocument/CatalogAction/CatalogActionHeader/Extension[@name='CICCode']/text()">inDoc</Parameter>
		<Parameter name="CICDescription" direction="in" type="string" eval="xpath" source="/Message/Body/Document/BusinessDocument/CatalogAction/CatalogActionHeader/Extension[@name='Description']/text()">inDoc</Parameter>
		<Parameter name="CICAdditionalDescription" direction="in" type="string" eval="xpath" source="/Message/Body/Document/BusinessDocument/CatalogAction/CatalogActionHeader/Extension[@name='AdditionalDescription']/Value/text()">inDoc</Parameter>
		<Parameter name="CICActionNeeded" direction="in" type="string" eval="xpath" source="/Message/Body/Document/BusinessDocument/CatalogAction/CatalogActionHeader/Extension[@name='ActionNeeded']/text()">inDoc</Parameter>
		<Parameter name="CICCorrectiveInfo" direction="in" type="string" eval="xpath" source="/Message/Body/Document/BusinessDocument/CatalogAction/CatalogActionHeader/Extension[@name='CorrectiveInfo']/Value/text()">inDoc</Parameter>
	</Activity>
	<Activity Name="GetItemDataForReview">
		<Action>GetRecord</Action>
		<Description>Get record data</Description>
		<Execution>SYNCHR</Execution>
		<Parameter name="eventState" direction="in" type="string" eval="constant">GETPRODUCTINFO</Parameter>
		<Parameter name="InDocument" direction="in" type="document" eval="variable">inDoc</Parameter>
		<Parameter name="Agency" direction="in" type="string" eval="constant">SOURCE</Parameter>
		<Parameter name="RelationshipDepth" direction="in" type="long" eval="constant">-1</Parameter>
		<Parameter name="MasterCatalog" direction="in" type="long" eval="xpath" source="/Message/Body/Document/BusinessDocument/CatalogAction/CatalogActionHeader/MasterCatalog/RevisionID/DBID/text()">inDoc</Parameter>
		<Parameter name="RelationshipName" direction="in" type="string" eval="constant">Contains</Parameter>
		<Parameter name="OutDocument" direction="out" eval="variable" type="document">workDoc</Parameter>
	</Activity>
	<Activity Name="ManageRecordCollectionForCICReviewMessage">
		<Action>ManageRecordCollection</Action>
		<Description>Construct record list</Description>
		<Execution>SYNCHR</Execution>
		<Parameter name="eventState" direction="in" type="string" eval="constant">IDENTIFYVERSION</Parameter>
		<Parameter name="InDocument" direction="in" type="document" eval="variable">inDoc</Parameter>
		<Parameter name="RelationshipName" direction="in" type="string" eval="constant">Contains</Parameter>
		<Parameter name="VersionOption" direction="in" type="string" eval="constant">LATEST</Parameter>
		<Parameter name="BundlingOption" direction="in" type="boolean" eval="constant">true</Parameter>
		<Parameter name="SetRecordListReadOnly" direction="in" type="boolean" eval="constant">false</Parameter>
		<Parameter name="OutRecordList" direction="out" eval="variable" type="recordlist">workRecordList</Parameter>
	</Activity>
	<Activity Name="SetStatusCodeToReview">
		<Action>EvaluateRuleBase</Action>
		<Description>Set Status code to Review</Description>
		<Execution>SYNCHR</Execution>
		<Parameter name="eventState" direction="in" type="string" eval="constant">EVALUATERULEBASE</Parameter>
		<Parameter name="Rulebase" direction="in" type="string" eval="constant">MDRITME1/rulebase/MIX/rb_dm_set_STATUS_REVIEW_MIX.xml</Parameter>
		<Parameter name="InRecordList" direction="in" type="recordlist" eval="variable">workRecordListNew</Parameter>
		<Parameter name="recKeyList1" direction="in" type="arraylist" eval="variable">recKeyList</Parameter>
		<Parameter name="Severity" direction="in" type="long" eval="constant">9</Parameter>
		<Parameter name="RemoveRecord" direction="in" type="string" eval="constant">FATAL</Parameter>
		<Parameter name="SaveFlag" direction="in" type="string" eval="constant">SAVE</Parameter>
		<Parameter name="AllowDuplicateInOutput" direction="in" type="boolean" eval="constant">false</Parameter>
		<Parameter name="recKeyList2" direction="out" eval="variable" type="arraylist">recKeyList2</Parameter>
		<Parameter name="ValidationErrors" direction="out" eval="variable" type="long">fatalErrors</Parameter>
		<Parameter name="ValidationErrors1" direction="out" eval="variable" type="long">warningErrors</Parameter>
	</Activity>
	<Activity Name="UpdateRecordStateAsReviewed">
		<Action>UpdateRecordState</Action>
		<Description>Review selected record versions</Description>
		<Execution>SYNCHR</Execution>
		<Parameter name="eventState" direction="in" type="string" eval="constant">UPDATERECORDSTATUS</Parameter>
		<Parameter name="Status" direction="in" type="string" eval="constant">REJECTED</Parameter>
		<Parameter name="AsynProcessIndicator" direction="in" type="boolean" eval="constant">false</Parameter>
		<Parameter name="RecordKey" direction="in" type="arraylist" eval="variable">recKeyList2</Parameter>
	</Activity>
	<Activity Name="CheckForMoreMessagesRej">
		<Action>NoOperation</Action>
		<Description>Check if more response messages need to be sent</Description>
		<Execution>SYNCHR</Execution>
	</Activity>
	<Activity Name="GetAllInboundItemIDs1">
		<Action>Translate</Action>
		<Description>Translate to get all inbound item ids</Description>
		<Execution>SYNCHR</Execution>
		<Parameter name="Derived" direction="in" type="string" eval="constant">false</Parameter>
		<Parameter name="Translator" direction="in" type="string" eval="constant">XSLT</Parameter>
		<Parameter name="Map" direction="in" type="string" eval="constant">MDRITME1/maps/MIX/getItemIdsInStringFormat_MIX.xsl</Parameter>
		<Parameter name="OutputFormat" direction="in" type="string" eval="constant">XML</Parameter>
		<Parameter name="InDocument" direction="in" type="document" eval="variable">inDoc</Parameter>
		<Parameter name="eventState" direction="in" type="string" eval="constant">TRANSLATE</Parameter>
		<Parameter name="OutDocument" direction="out" eval="variable" type="document">workDoc123</Parameter>
	</Activity>
	<Activity Name="ExtractItemIDs1">
		<Action>EvaluateRuleBase</Action>
		<Description/>
		<Execution>SYNCHR</Execution>
		<Parameter name="InDocument" direction="in" type="document" eval="variable">inDoc</Parameter>
		<Parameter name="InDocument12" direction="in" type="document" eval="variable">workDoc123</Parameter>
		<Parameter name="AllItemID_STR" direction="in" type="string" eval="xpath" source="/Message/OriginalDocument/text()">workDoc123</Parameter>
		<Parameter name="ExecutionMode" direction="in" type="string" eval="constant">NoRecords</Parameter>
		<Parameter name="eventState" direction="in" type="string" eval="constant">EVALUATERULEBASE</Parameter>
		<Parameter name="RemoveRecord" direction="in" type="string" eval="constant">NONE</Parameter>
		<Parameter name="Rulebase" direction="in" type="string" eval="constant">MDRITME1/rulebase/MIX/rb_dm_GetAllItemIds_MIX.xml</Parameter>
		<Parameter name="Severity" direction="in" type="long" eval="constant">9</Parameter>
		<Parameter name="SaveFlag" direction="in" type="string" eval="constant">NOSAVE</Parameter>
		<Parameter name="EvaluateChildren" direction="in" type="boolean" eval="constant">true</Parameter>
		<Parameter name="AllowDuplicateInOutput" direction="in" type="boolean" eval="constant">true</Parameter>
		<Parameter name="AsyncProcessIndicator" direction="in" type="boolean" eval="constant">false</Parameter>
		<Parameter name="AllItemID_Array" direction="out" eval="variable" type="arraylist">AllItemID_Array</Parameter>
		<Parameter name="ValidationErrors" direction="out" eval="variable" type="long">fatalErrors</Parameter>
		<Parameter name="ValidationErrors1" direction="out" eval="variable" type="long">warningErrors</Parameter>
		<Parameter name="OutDocument" direction="out" eval="variable" type="document">workDoc</Parameter>
	</Activity>
	<Activity Name="GetListofGtinsAndProdTypes">
		<Action>EvaluateRuleBase</Action>
		<Description>Get CIC review Message</Description>
		<Execution>SYNCHR</Execution>
		<Parameter name="eventState" direction="in" type="string" eval="constant">EVALUATERULEBASE</Parameter>
		<Parameter name="InDocument" direction="in" type="document" eval="variable">inDoc</Parameter>
		<Parameter name="Rulebase" direction="in" type="string" eval="constant">MDRITME1/rulebase/MIX/rb_dm_getListofGtinsAndProdTypes.xml</Parameter>
		<Parameter name="Severity" direction="in" type="long" eval="constant">9</Parameter>
		<Parameter name="RemoveRecord" direction="in" type="string" eval="constant">FATAL</Parameter>
		<Parameter name="SaveFlag" direction="in" type="string" eval="constant">NOSAVE</Parameter>
		<Parameter name="AllGTINS" direction="in" type="arraylist" eval="variable">AllItemID_Array</Parameter>
		<Parameter name="listOfGtins" direction="out" eval="variable" type="arraylist">listOfGtins</Parameter>
		<Parameter name="listOfProductType" direction="out" eval="variable" type="arraylist">listOfProductType</Parameter>
		<Parameter name="ValidationErrors" direction="out" eval="variable" type="long">fatalErrors</Parameter>
		<Parameter name="ValidationErrors1" direction="out" eval="variable" type="long">warningErrors</Parameter>
	</Activity>
	<Activity Name="GetCICReviewMessage">
		<Action>EvaluateRuleBase</Action>
		<Description>Get CIC review Message</Description>
		<Execution>SYNCHR</Execution>
		<Parameter name="eventState" direction="in" type="string" eval="constant">EVALUATERULEBASE</Parameter>
		<Parameter name="Rulebase" direction="in" type="string" eval="constant">MDRITME1/rulebase/MIX/rb_dm_getCICReviewMessage_MIX.xml</Parameter>
		<Parameter name="Severity" direction="in" type="long" eval="constant">9</Parameter>
		<Parameter name="RemoveRecord" direction="in" type="string" eval="constant">FATAL</Parameter>
		<Parameter name="SaveFlag" direction="in" type="string" eval="constant">NOSAVE</Parameter>
		<Parameter name="listOfGtins1" direction="in" type="arraylist" eval="variable">listOfGtins</Parameter>
		<Parameter name="listOfProductType1" direction="in" type="arraylist" eval="variable">listOfProductType</Parameter>
		<Parameter name="InCICReviewMessage" direction="in" type="string" eval="variable">message</Parameter>
		<Parameter name="ExecutionMode" direction="in" type="string" eval="constant">NoRecords</Parameter>
		<Parameter name="CICReviewMessage" direction="out" eval="variable" type="string">CICReviewMessage</Parameter>
		<Parameter name="ValidationErrors" direction="out" eval="variable" type="long">fatalErrors</Parameter>
		<Parameter name="ValidationErrors1" direction="out" eval="variable" type="long">warningErrors</Parameter>
	</Activity>
	<Activity Name="EvaluateRuleBaseContainsForReview">
		<Action>EvaluateRuleBase</Action>
		<Description>Apply validation rules</Description>
		<Execution>SYNCHR</Execution>
		<Parameter name="eventState" direction="in" type="string" eval="constant">EVALUATERULEBASE</Parameter>
		<Parameter name="Rulebase" direction="in" type="string" eval="constant">MDRITME1/rulebase/MIX/rb_CheckItemMaster_MIX.xml</Parameter>
		<Parameter name="InRecordList" direction="in" type="recordlist" eval="variable">workRecordList</Parameter>
		<Parameter name="Severity" direction="in" type="long" eval="constant">9</Parameter>
		<Parameter name="RemoveRecord" direction="in" type="string" eval="constant">FATAL</Parameter>
		<Parameter name="SaveFlag" direction="in" type="string" eval="constant">SAVE</Parameter>
		<Parameter name="ValidationErrors" direction="out" eval="variable" type="long">fatalErrors</Parameter>
		<Parameter name="ValidationErrors1" direction="out" eval="variable" type="long">warningErrors</Parameter>
		<Parameter name="OutRecordList" direction="out" eval="variable" type="recordlist">workRecordList</Parameter>
		<Parameter name="OutRecordList2" direction="out" eval="variable" type="recordlist">workRecordList1</Parameter>
	</Activity>
	<Activity Name="IdentifyProtocolOperationsFor1SyncCICReview">
		<Action>IdentifyProtocolOperations</Action>
		<Description>Identify operations to be performed for each record</Description>
		<Execution>SYNCHR</Execution>
		<Parameter name="InDocument" direction="in" type="document" eval="variable">inDoc</Parameter>
		<Parameter name="ReferenceStepID" direction="in" type="long" eval="variable">pl1</Parameter>
		<Parameter name="InRecordList" direction="in" type="recordlist" eval="variable">workRecordList</Parameter>
		<Parameter name="REVIEW_FLAG" direction="in" type="string" eval="constant">TRUE</Parameter>
		<Parameter name="eventState" direction="in" type="string" eval="constant">IDENTIFYOPERATION</Parameter>
		<Parameter name="DATAPOOL_ID" direction="in" type="string" eval="xpath" source="/Message/Header/MessageHeader[@role='Channel']/Organization/PartyID/DBID/text()">workDoc</Parameter>
		<Parameter name="BUYER_ID" direction="in" type="string" eval="xpath" source="/Message/Header/MessageHeader[@role='Retailer']/Organization/PartyID/DBID/text()">workDoc</Parameter>
		<Parameter name="OutRecordList" direction="out" eval="variable" type="recordlist">workRecordList</Parameter>
		<Parameter name="AsyncStepID" direction="out" eval="variable" type="long">prlog2</Parameter>
	</Activity>
	<Activity Name="HandleProtocolMessageFor1syncCICReview">
		<Action>HandleMessaging</Action>
		<Description>Begin sending accept message</Description>
		<Execution>SYNCHR</Execution>
		<Parameter name="eventState" direction="in" type="string" eval="constant">CREATEMESSAGE</Parameter>
		<Parameter name="CommandsPerMessage" direction="in" type="long" eval="constant">50</Parameter>
		<Parameter name="InDocument" direction="in" type="document" eval="variable">inDoc</Parameter>
		<Parameter name="ResponseRequired" direction="in" type="boolean" eval="constant">true</Parameter>
		<Parameter name="ProtocolMessagingCommand" direction="in" type="string" eval="variable">nextCmd</Parameter>
		<Parameter name="ReferenceStepID" direction="in" type="long" eval="variable">prlog2</Parameter>
		<Parameter name="InRecordList" direction="in" type="recordlist" eval="variable">workRecordList</Parameter>
		<Parameter name="OutRecordList" direction="out" eval="variable" type="recordlist">workRecordList</Parameter>
		<Parameter name="OutDocument" direction="out" eval="variable" type="document">messageDoc</Parameter>
		<Parameter name="ProtocolMessagingNextCommand" direction="out" eval="variable" type="string">nextCmd</Parameter>
		<Parameter name="ProtocolMessageGenerated" direction="out" eval="variable" type="boolean">msgGenerated</Parameter>
	</Activity>
	<Activity Name="TranslateActivityToConvertToCICReviewFormat">
		<Action>Translate</Action>
		<Description>Generate the accept message</Description>
		<Execution>SYNCHR</Execution>
		<Parameter name="eventState" direction="in" type="string" eval="constant">TRANSLATE</Parameter>
		<Parameter name="Derived" direction="in" type="string" eval="constant">false</Parameter>
		<Parameter name="Translator" direction="in" type="string" eval="constant">XSLT</Parameter>
		<Parameter name="Xsl_Param_CICCode" direction="in" type="string" eval="constant">CIC999</Parameter>
		<Parameter name="Xsl_Param_CICDescription" direction="in" type="string" eval="variable">CICReviewMessage</Parameter>
		<Parameter name="Xsl_Param_REVIEW_FROM" direction="in" type="string" eval="constant">GRISSOM1_DM</Parameter>
		<Parameter name="Map" direction="in" type="string" eval="constant">MDRITME1/maps/MIX/1syncCICReview_withParam_MIX.xsl</Parameter>
		<Parameter name="OutputFormat" direction="in" type="string" eval="constant">XML</Parameter>
		<Parameter name="Normalize" direction="in" type="string" eval="constant">None</Parameter>
		<Parameter name="InDocument" direction="in" type="document" eval="variable">messageDoc</Parameter>
		<Parameter name="Xsl_Param_Environment_Name" direction="in" type="string" eval="variable">Environment_Name4</Parameter>
		<Parameter name="OutDocument" direction="out" eval="variable" type="document">syncDoc</Parameter>
	</Activity>
	<Activity Name="Publish1SyncCICReviewMessage">
		<Action>SendProtocolMessage</Action>
		<Description>Publish the 1Sync CIC Review Message to JMS for EAI to pickup</Description>
		<Execution>ASYNCHR</Execution>
		<Parameter name="BizProtocol" direction="in" type="string" eval="constant">JMS</Parameter>
		<Parameter name="InDocument" direction="in" type="document" eval="variable">syncDoc</Parameter>
		<Parameter name="SupplierCredential" direction="in" type="string" eval="xpath" source="/Message/Header/MessageHeader[@role='Supplier']/Credential[@domain='GLN']/Identity/text()">inDoc</Parameter>
		<Parameter name="SenderCredential" direction="in" type="string" eval="xpath" source="/Message/Header/MessageHeader[@role='Retailer']/Credential[@domain='GLN']/Identity/text()">inDoc</Parameter>
		<Parameter name="ChannelCredential" direction="in" type="string" eval="xpath" source="/Message/Header/MessageHeader[@role='Channel']/Credential[@domain='GLN']/Identity/text()">inDoc</Parameter>
		<Parameter name="ChannelOrganizationName" direction="in" type="string" eval="xpath" source="/Message/Header/MessageHeader[@role='Channel']/Organization/PartyID/PartyName/text()">inDoc</Parameter>
		<Parameter name="MessageID1" direction="in" type="string" eval="xpath" source="/Message/Body/Document/BusinessDocument/CatalogAction/CatalogActionHeader/PackageData/@messageID">messageDoc</Parameter>
		<Parameter name="eventState" direction="in" type="string" eval="constant">SENDMESSAGE</Parameter>
		<Parameter name="TrackMessageResponse" direction="in" type="boolean" eval="constant">false</Parameter>
		<Parameter name="OutDocument" direction="out" eval="variable" type="document">responseDoc</Parameter>
	</Activity>
	<Activity Name="ConvertRecordsToOutputFormat1Sync">
		<Action>ConvertRecordToOutput</Action>
		<Description>Convert records to output format</Description>
		<Execution>SYNCHR</Execution>
		<Parameter name="eventState" direction="in" type="string" eval="constant">CONVERTTOOUTPUT</Parameter>
		<Parameter name="InDocument" direction="in" type="document" eval="variable">inDoc</Parameter>
		<Parameter name="InRecordList" direction="in" type="recordlist" eval="variable">workRecordList</Parameter>
		<Parameter name="CatalogOutputMap" direction="in" type="string" eval="constant">ITEM_MASTER_1SYNC_OM</Parameter>
		<Parameter name="OutRecordList" direction="out" eval="variable" type="recordlist">workRecordList</Parameter>
		<Parameter name="OutRecordList2" direction="out" eval="variable" type="recordlist">mcRecordList</Parameter>
		<Parameter name="StepID" direction="out" eval="variable" type="long">pl1</Parameter>
	</Activity>
	<Activity Name="GetAllInboundItemIDs">
		<Action>Translate</Action>
		<Description>Translate to get all inbound item ids</Description>
		<Execution>SYNCHR</Execution>
		<Parameter name="Derived" direction="in" type="string" eval="constant">false</Parameter>
		<Parameter name="Translator" direction="in" type="string" eval="constant">XSLT</Parameter>
		<Parameter name="Map" direction="in" type="string" eval="constant">MDRITME1/maps/MIX/getItemIdsInStringFormat_MIX.xsl</Parameter>
		<Parameter name="OutputFormat" direction="in" type="string" eval="constant">XML</Parameter>
		<Parameter name="InDocument" direction="in" type="document" eval="variable">inDoc</Parameter>
		<Parameter name="eventState" direction="in" type="string" eval="constant">TRANSLATE</Parameter>
		<Parameter name="OutDocument" direction="out" eval="variable" type="document">workDoc123</Parameter>
	</Activity>
	<Activity Name="ExtractItemIDs">
		<Action>EvaluateRuleBase</Action>
		<Description/>
		<Execution>SYNCHR</Execution>
		<Parameter name="InDocument" direction="in" type="document" eval="variable">inDoc</Parameter>
		<Parameter name="InDocument12" direction="in" type="document" eval="variable">workDoc123</Parameter>
		<Parameter name="AllItemID_STR" direction="in" type="string" eval="xpath" source="/Message/OriginalDocument/text()">workDoc123</Parameter>
		<Parameter name="ExecutionMode" direction="in" type="string" eval="constant">NoRecords</Parameter>
		<Parameter name="eventState" direction="in" type="string" eval="constant">EVALUATERULEBASE</Parameter>
		<Parameter name="RemoveRecord" direction="in" type="string" eval="constant">NONE</Parameter>
		<Parameter name="Rulebase" direction="in" type="string" eval="constant">MDRITME1/rulebase/MIX/rb_dm_GetAllItemIds_MIX.xml</Parameter>
		<Parameter name="Severity" direction="in" type="long" eval="constant">9</Parameter>
		<Parameter name="SaveFlag" direction="in" type="string" eval="constant">NOSAVE</Parameter>
		<Parameter name="EvaluateChildren" direction="in" type="boolean" eval="constant">true</Parameter>
		<Parameter name="AllowDuplicateInOutput" direction="in" type="boolean" eval="constant">true</Parameter>
		<Parameter name="AsyncProcessIndicator" direction="in" type="boolean" eval="constant">false</Parameter>
		<Parameter name="AllItemID_Array" direction="out" eval="variable" type="arraylist">AllItemID_Array</Parameter>
		<Parameter name="ValidationErrors" direction="out" eval="variable" type="long">fatalErrors</Parameter>
		<Parameter name="ValidationErrors1" direction="out" eval="variable" type="long">warningErrors</Parameter>
		<Parameter name="OutDocument" direction="out" eval="variable" type="document">workDoc</Parameter>
	</Activity>
	<Activity Name="FilterRecordsToBeRejected">
		<Action>EvaluateRuleBase</Action>
		<Description>Filter all the records which needs to be deleted</Description>
		<Execution>SYNCHR</Execution>
		<Parameter name="eventState" direction="in" type="string" eval="constant">EVALUATERULEBASE</Parameter>
		<Parameter name="InRecordList" direction="in" type="recordlist" eval="variable">workRecordListNew</Parameter>
		<Parameter name="Rulebase" direction="in" type="string" eval="constant">MDRITME1/rulebase/MIX/rb_dm_FilterDeleteRecList_MIX.xml</Parameter>
		<Parameter name="Severity" direction="in" type="long" eval="constant">9</Parameter>
		<Parameter name="SaveFlag" direction="in" type="string" eval="constant">SAVE</Parameter>
		<Parameter name="inboundRecordList" direction="in" type="arraylist" eval="variable">AllItemID_Array</Parameter>
		<Parameter name="EvaluateChildren" direction="in" type="boolean" eval="constant">true</Parameter>
		<Parameter name="AllowDuplicateInOutput" direction="in" type="boolean" eval="constant">true</Parameter>
		<Parameter name="deltedRecList" direction="out" eval="variable" type="arraylist">deltedRecList</Parameter>
		<Parameter name="deltedReckeyList" direction="out" eval="variable" type="arraylist">deltedReckeyList</Parameter>
		<Parameter name="ValidationErrors" direction="out" eval="variable" type="long">fatalErrors</Parameter>
		<Parameter name="ValidationErrors1" direction="out" eval="variable" type="long">warningErrors</Parameter>
		<Parameter name="OutDocument" direction="out" eval="variable" type="document">workDoc</Parameter>
	</Activity>
	<Activity Name="ConcatRecordsIDsToBeRejected">
		<Action>EvaluateRuleBase</Action>
		<Description>Concat all the records which needs to be deleted</Description>
		<Execution>SYNCHR</Execution>
		<Parameter name="eventState" direction="in" type="string" eval="constant">EVALUATERULEBASE</Parameter>
		<Parameter name="ExecutionMode" direction="in" type="string" eval="constant">NoRecords</Parameter>
		<Parameter name="Rulebase" direction="in" type="string" eval="constant">MDRITME1/rulebase/MIX/rb_dm_concatItemIds_MIX.xml</Parameter>
		<Parameter name="Severity" direction="in" type="long" eval="constant">9</Parameter>
		<Parameter name="deltedRecList1" direction="in" type="arraylist" eval="variable">deltedRecList</Parameter>
		<Parameter name="AllowDuplicateInOutput" direction="in" type="boolean" eval="constant">true</Parameter>
		<Parameter name="concatRecList" direction="out" eval="variable" type="string">concatRecList</Parameter>
		<Parameter name="ValidationErrors" direction="out" eval="variable" type="long">fatalErrors</Parameter>
		<Parameter name="ValidationErrors1" direction="out" eval="variable" type="long">warningErrors</Parameter>
		<Parameter name="OutDocument" direction="out" eval="variable" type="document">workDoc</Parameter>
		<Parameter name="delconcatRecList" direction="out" eval="variable" type="string">delconcatRecList1</Parameter>
	</Activity>
	<Activity Name="Getdummy">
		<Action>Translate</Action>
		<Description>Generate the accept message</Description>
		<Execution>SYNCHR</Execution>
		<Parameter name="eventState" direction="in" type="string" eval="constant">TRANSLATE</Parameter>
		<Parameter name="Derived" direction="in" type="string" eval="constant">false</Parameter>
		<Parameter name="Translator" direction="in" type="string" eval="constant">XSLT</Parameter>
		<Parameter name="Map" direction="in" type="string" eval="constant">MDRITME1/maps/MIX/generateDummyInDoc_DM_DELETE_MIX.xsl</Parameter>
		<Parameter name="OutputFormat" direction="in" type="string" eval="constant">mlXML</Parameter>
		<Parameter name="Normalize" direction="in" type="string" eval="constant">None</Parameter>
		<Parameter name="Xsl_Param_productIDs" direction="in" type="string" eval="variable">concatRecList</Parameter>
		<Parameter name="InDocument" direction="in" type="document" eval="variable">workDoc</Parameter>
		<Parameter name="OutDocument" direction="out" eval="variable" type="document">dummyDoc</Parameter>
	</Activity>
	<Activity Name="GetItemData1">
		<Action>GetRecord</Action>
		<Description>Get record data</Description>
		<Execution>SYNCHR</Execution>
		<Parameter name="InDocument" direction="in" type="document" eval="variable">dummyDoc</Parameter>
		<Parameter name="Agency" direction="in" type="string" eval="constant">SOURCE</Parameter>
		<Parameter name="MasterCatalog" direction="in" type="long" eval="xpath" source="/Message/Body/Document/BusinessDocument/CatalogAction/CatalogActionHeader/MasterCatalog/RevisionID/DBID/text()">inDoc</Parameter>
		<Parameter name="RelationshipName" direction="in" type="string" eval="constant">Contains</Parameter>
		<Parameter name="RelationshipDepth" direction="in" type="long" eval="constant">-1</Parameter>
		<Parameter name="OutDocument" direction="out" eval="variable" type="document">workDoc</Parameter>
	</Activity>
	<Activity Name="ManageRecordCollectionforRejectITEM">
		<Action>ManageRecordCollection</Action>
		<Description>Construct record list</Description>
		<Execution>SYNCHR</Execution>
		<Parameter name="eventState" direction="in" type="string" eval="constant">IDENTIFYVERSION</Parameter>
		<Parameter name="VersionOption" direction="in" type="string" eval="constant">LATEST</Parameter>
		<Parameter name="RelationshipName" direction="in" type="string" eval="constant">Item_Master_Corporate_Average_List_Cost</Parameter>
		<Parameter name="BundlingOption" direction="in" type="boolean" eval="constant">true</Parameter>
		<Parameter name="AsynProcessIndicator" direction="in" type="boolean" eval="constant">false</Parameter>
		<Parameter name="InDocument" direction="in" type="document" eval="variable">workDoc</Parameter>
		<Parameter name="RelationshipName1" direction="in" type="string" eval="constant">Item_Master_Food_And_Bev_Allergen_MVL</Parameter>
		<Parameter name="RelationshipName2" direction="in" type="string" eval="constant">Item_Master_Food_And_Bev_Diet_MVL</Parameter>
		<Parameter name="RelationshipName3" direction="in" type="string" eval="constant">Item_Master_Food_And_Bev_Ingredient_MVL</Parameter>
		<Parameter name="RelationshipName4" direction="in" type="string" eval="constant">Item_Master_Food_And_Bev_Nutrifacts_MVL</Parameter>
		<Parameter name="RelationshipName5" direction="in" type="string" eval="constant">Item_Master_Food_And_Bev_Prep_MVL</Parameter>
		<Parameter name="RelationshipName6" direction="in" type="string" eval="constant">Item_Master_Authorized_Region_MVL</Parameter>
		<Parameter name="RelationshipName7" direction="in" type="string" eval="constant">Item_Master_Measures_MVL</Parameter>
		<Parameter name="RelationshipName8" direction="in" type="string" eval="constant">Item_Master_Weight_MVL</Parameter>
		<Parameter name="RelationshipName9" direction="in" type="string" eval="constant">Item_Master_Temperature_MVL</Parameter>
		<Parameter name="RelationshipName10" direction="in" type="string" eval="constant">Item_Master_GPC_BRICK_MVL</Parameter>
		<Parameter name="RelationshipName11" direction="in" type="string" eval="constant">Item_Master_Peg_Measurement_MVL</Parameter>
		<Parameter name="RelationshipName12" direction="in" type="string" eval="constant">Images_for_Item</Parameter>
		<Parameter name="RelationshipName13" direction="in" type="string" eval="constant">Descriptions_for_Item</Parameter>
		<Parameter name="RelationshipName14" direction="in" type="string" eval="constant">Item_Organic_Claim</Parameter>
		<Parameter name="RelationshipName15" direction="in" type="string" eval="constant">Item_Master_Manufacturer_MVL</Parameter>
		<Parameter name="RelationshipName16" direction="in" type="string" eval="constant">Item_Master_CataloguePrice_MVL</Parameter>
		<Parameter name="RelationshipName17" direction="in" type="string" eval="constant">Item_Master_FlashPointTemperature_MVL</Parameter>
		<Parameter name="RelationshipName18" direction="in" type="string" eval="constant">Item_Master_OrderSizingFactor_MVL</Parameter>
		<Parameter name="RelationshipName19" direction="in" type="string" eval="constant">Item_Master_RetailPriceOnTradeItem_MVL</Parameter>
		<Parameter name="RelationshipName20" direction="in" type="string" eval="constant">Item_Master_Promotional_Trade_Item_MVL</Parameter>
		<Parameter name="RelationshipName21" direction="in" type="string" eval="constant">Item_Master_FunctionalName_MVL</Parameter>
		<Parameter name="RelationshipName22" direction="in" type="string" eval="constant">Item_Master_GTINName_MVL</Parameter>
		<Parameter name="RelationshipName23" direction="in" type="string" eval="constant">Item_Master_HandlingInstructionCode_MVL</Parameter>
		<Parameter name="OutRecordList" direction="out" eval="variable" type="recordlist">workRecordListNew</Parameter>
	</Activity>
	<Activity Name="ExtractRecordKeys">
		<Action>EvaluateRuleBase</Action>
		<Description>Fetch all record keys to be deleted</Description>
		<Execution>SYNCHR</Execution>
		<Parameter name="eventState" direction="in" type="string" eval="constant">EVALUATERULEBASE</Parameter>
		<Parameter name="InRecordList" direction="in" type="recordlist" eval="variable">workRecordListNew</Parameter>
		<Parameter name="Rulebase" direction="in" type="string" eval="constant">MDRITME1/rulebase/MIX/rb_dm_extractRecKeysForDelete_MIX.xml</Parameter>
		<Parameter name="Severity" direction="in" type="long" eval="constant">9</Parameter>
		<Parameter name="SaveFlag" direction="in" type="string" eval="constant">NOSAVE</Parameter>
		<Parameter name="EvaluateChildren" direction="in" type="boolean" eval="constant">true</Parameter>
		<Parameter name="AllowDuplicateInOutput" direction="in" type="boolean" eval="constant">false</Parameter>
		<Parameter name="delproductIDs" direction="in" type="string" eval="variable">concatRecList</Parameter>
		<Parameter name="recKeyList" direction="out" eval="variable" type="arraylist">recKeyList</Parameter>
		<Parameter name="ValidationErrors" direction="out" eval="variable" type="long">fatalErrors</Parameter>
		<Parameter name="ValidationErrors1" direction="out" eval="variable" type="long">warningErrors</Parameter>
		<Parameter name="OutDocument" direction="out" eval="variable" type="document">workDoc</Parameter>
	</Activity>
	<Activity Name="ManageRecordCollectionBeforeReject">
		<Action>ManageRecordCollection</Action>
		<Description>Construct record list</Description>
		<Execution>SYNCHR</Execution>
		<Parameter name="eventState" direction="in" type="string" eval="constant">IDENTIFYVERSION</Parameter>
		<Parameter name="RelationshipName" direction="in" type="string" eval="constant">Contains</Parameter>
		<Parameter name="VersionOption" direction="in" type="string" eval="constant">LATEST</Parameter>
		<Parameter name="BundlingOption" direction="in" type="boolean" eval="constant">true</Parameter>
		<Parameter name="AsynProcessIndicator" direction="in" type="boolean" eval="constant">false</Parameter>
		<Parameter name="InDocument" direction="in" type="document" eval="variable">workDoc</Parameter>
		<Parameter name="OutRecordList" direction="out" eval="variable" type="recordlist">workRecordListNew</Parameter>
	</Activity>
	<Activity Name="UpdateHierarchyRoleStatus">
		<Action>SaveRecord</Action>
		<Description/>
		<Execution>SYNCHR</Execution>
		<Parameter name="eventState" direction="in" type="string" eval="constant">SAVERECORD</Parameter>
		<Parameter name="MasterCatalog" direction="in" type="string" eval="constant">HierarchyRoles</Parameter>
		<Parameter name="ProductIds" direction="in" type="string" eval="xpath" source="/Message/Body/Document/OriginalDocument/os:envelope/catalogueItemNotification/document/hierarchyInformation[1]/publishedGTIN/text()">inDoc</Parameter>
		<Parameter name="VersionOption" direction="in" type="string" eval="constant">LATEST</Parameter>
		<Parameter name="GenerateExistenceError" direction="in" type="string" eval="constant">false</Parameter>
		<Parameter name="Severity" direction="in" type="long" eval="constant">9</Parameter>
		<Parameter name="StandardValidation" direction="in" type="boolean" eval="constant">false</Parameter>
		<Parameter name="AsynProcessIndicator" direction="in" type="boolean" eval="constant">false</Parameter>
		<Parameter name="Overwrite" direction="in" type="boolean" eval="constant">true</Parameter>
		<Parameter name="OverrideConflict" direction="in" type="boolean" eval="constant">true</Parameter>
		<Parameter name="RecordPerAsyncCall" direction="in" type="long" eval="constant">10</Parameter>
		<Parameter name="ATTRIBUTE_ITEM_HIERARCHY_STATUS_CD" direction="in" type="string" eval="variable">HierarchyRolesStatus</Parameter>
		<Parameter name="ATTRIBUTE_VENUS_REASON_CD" direction="in" type="string" eval="variable">message</Parameter>
		<Parameter name="ATTRIBUTE_ROLE_UPDATE_TS" direction="in" type="string" eval="variable">CurrentTimeStamp</Parameter>
		<Parameter name="RecordsAttempted" direction="out" eval="variable" type="long">attemptedCount</Parameter>
		<Parameter name="RecordsWithErrors" direction="out" eval="variable" type="long">errorsFound</Parameter>
	</Activity>
	<Activity Name="UpdateHierRoleConfirmed">
		<Action>UpdateRecordState</Action>
		<Description>Set Hierarchy Roles record status as confirmed</Description>
		<Execution>SYNCHR</Execution>
		<Parameter name="OverrideConflict" direction="in" type="boolean" eval="constant">true</Parameter>
		<Parameter name="eventState" direction="in" type="string" eval="constant">UPDATERECORDSTATUS</Parameter>
		<Parameter name="Status" direction="in" type="string" eval="constant">CONFIRMED</Parameter>
		<Parameter name="ProductIds" direction="in" type="string" eval="xpath" source="/Message/Body/Document/OriginalDocument/os:envelope/catalogueItemNotification/document/hierarchyInformation[1]/publishedGTIN/text()">inDoc</Parameter>
		<Parameter name="MasterCatalog" direction="in" type="string" eval="constant">HierarchyRoles</Parameter>
	</Activity>
	<Activity Name="GetTimeStamp">
		<Action>EvaluateRuleBase</Action>
		<Description>Check Item is Confirmed or If should be published</Description>
		<Execution>SYNCHR</Execution>
		<Parameter name="eventState" direction="in" type="string" eval="constant">EVALUATERULEBASE</Parameter>
		<Parameter name="AllowDuplicateInOutput" direction="in" type="boolean" eval="constant">true</Parameter>
		<Parameter name="Rulebase" direction="in" type="string" eval="constant">MDRITME1/rulebase/MIX/rb_SharedObjects_MIX.xml</Parameter>
		<Parameter name="SaveFlag" direction="in" type="string" eval="constant">NOSAVE</Parameter>
		<Parameter name="EvaluateChildren" direction="in" type="boolean" eval="constant">true</Parameter>
		<Parameter name="ExecutionMode" direction="in" type="string" eval="constant">AllRecords</Parameter>
		<Parameter name="VersionOption" direction="in" type="string" eval="constant">LATEST</Parameter>
		<Parameter name="InRecordList" direction="in" type="recordlist" eval="variable">workRecordListNew</Parameter>
		<Parameter name="Publish_GTIN" direction="in" type="string" eval="xpath" source="/Message/Body/Document/OriginalDocument/os:envelope/catalogueItemNotification/document/hierarchyInformation[1]/publishedGTIN/text()">inDoc</Parameter>
		<Parameter name="Status" direction="in" type="string" eval="constant">UNCONFIRMED</Parameter>
		<Parameter name="CurrentTimeStamp" direction="out" eval="variable" type="string">CurrentTimeStamp</Parameter>
	</Activity>
	<Activity Name="UpdateRecordStateUnConfirmed">
		<Action>UpdateRecordState</Action>
		<Description>Review selected record versions</Description>
		<Execution>SYNCHR</Execution>
		<Parameter name="eventState" direction="in" type="string" eval="constant">UPDATERECORDSTATUS</Parameter>
		<Parameter name="Status" direction="in" type="string" eval="constant">UNCONFIRMED</Parameter>
		<Parameter name="AsynProcessIndicator" direction="in" type="boolean" eval="constant">false</Parameter>
		<Parameter name="RecordKey" direction="in" type="arraylist" eval="variable">recKeyList2</Parameter>
	</Activity>
	<Activity Name="NoOpBeforeUpdatingRecordState">
		<Action>NoOperation</Action>
		<Description/>
		<Execution>SYNCHR</Execution>
	</Activity>
	<Activity Name="GetRecordForUpdate">
		<Action>GetRecord</Action>
		<Description>Get record data</Description>
		<Execution>SYNCHR</Execution>
		<Parameter name="eventState" direction="in" type="string" eval="constant">GETPRODUCTINFO</Parameter>
		<Parameter name="Agency" direction="in" type="string" eval="constant">SOURCE</Parameter>
		<Parameter name="RelationshipDepth" direction="in" type="long" eval="constant">-1</Parameter>
		<Parameter name="MasterCatalog" direction="in" type="long" eval="xpath" source="/Message/Body/Document/BusinessDocument/CatalogAction/CatalogActionHeader/MasterCatalog/RevisionID/DBID/text()">inDoc</Parameter>
		<Parameter name="RelationshipName" direction="in" type="string" eval="constant">Item_Master_Corporate_Average_List_Cost</Parameter>
		<Parameter name="InDocument" direction="in" type="document" eval="variable">outTypeDoc</Parameter>
		<Parameter name="RelationshipName1" direction="in" type="string" eval="constant">Item_Master_Food_And_Bev_Allergen_MVL</Parameter>
		<Parameter name="RelationshipName2" direction="in" type="string" eval="constant">Item_Master_Food_And_Bev_Diet_MVL</Parameter>
		<Parameter name="RelationshipName3" direction="in" type="string" eval="constant">Item_Master_Food_And_Bev_Ingredient_MVL</Parameter>
		<Parameter name="RelationshipName4" direction="in" type="string" eval="constant">Item_Master_Food_And_Bev_Nutrifacts_MVL</Parameter>
		<Parameter name="RelationshipName5" direction="in" type="string" eval="constant">Item_Master_Food_And_Bev_Prep_MVL</Parameter>
		<Parameter name="RelationshipName6" direction="in" type="string" eval="constant">Item_Master_Authorized_Region_MVL</Parameter>
		<Parameter name="RelationshipName7" direction="in" type="string" eval="constant">Item_Master_Measures_MVL</Parameter>
		<Parameter name="RelationshipName8" direction="in" type="string" eval="constant">Item_Master_Weight_MVL</Parameter>
		<Parameter name="RelationshipName9" direction="in" type="string" eval="constant">Item_Master_Temperature_MVL</Parameter>
		<Parameter name="RelationshipName10" direction="in" type="string" eval="constant">Item_Master_GPC_BRICK_MVL</Parameter>
		<Parameter name="RelationshipName11" direction="in" type="string" eval="constant">Item_Master_Peg_Measurement_MVL</Parameter>
		<Parameter name="RelationshipName12" direction="in" type="string" eval="constant">Images_for_Item</Parameter>
		<Parameter name="RelationshipName13" direction="in" type="string" eval="constant">Descriptions_for_Item</Parameter>
		<Parameter name="RelationshipName14" direction="in" type="string" eval="constant">Item_Organic_Claim</Parameter>
		<Parameter name="RelationshipName15" direction="in" type="string" eval="constant">Item_Master_Manufacturer_MVL</Parameter>
		<Parameter name="RelationshipName16" direction="in" type="string" eval="constant">Item_Master_CataloguePrice_MVL</Parameter>
		<Parameter name="RelationshipName17" direction="in" type="string" eval="constant">Item_Master_FlashPointTemperature_MVL</Parameter>
		<Parameter name="RelationshipName18" direction="in" type="string" eval="constant">Item_Master_OrderSizingFactor_MVL</Parameter>
		<Parameter name="RelationshipName19" direction="in" type="string" eval="constant">Item_Master_RetailPriceOnTradeItem_MVL</Parameter>
		<Parameter name="RelationshipName20" direction="in" type="string" eval="constant">Item_Master_Promotional_Trade_Item_MVL</Parameter>
		<Parameter name="RelationshipName21" direction="in" type="string" eval="constant">Item_Master_FunctionalName_MVL</Parameter>
		<Parameter name="RelationshipName22" direction="in" type="string" eval="constant">Item_Master_GTINName_MVL</Parameter>
		<Parameter name="RelationshipName23" direction="in" type="string" eval="constant">Item_Master_HandlingInstructionCode_MVL</Parameter>
		<Parameter name="OutDocument" direction="out" eval="variable" type="document">workDoc</Parameter>
	</Activity>
	<Activity Name="ChangeDocumentType">
		<Action>Translate</Action>
		<Description>Generate the accept message</Description>
		<Execution>SYNCHR</Execution>
		<Parameter name="eventState" direction="in" type="string" eval="constant">TRANSLATE</Parameter>
		<Parameter name="Derived" direction="in" type="string" eval="constant">true</Parameter>
		<Parameter name="Translator" direction="in" type="string" eval="constant">XSLT</Parameter>
		<Parameter name="Map" direction="in" type="string" eval="constant">MDRITME1/maps/MIX/changeDocumentType_MIX.xsl</Parameter>
		<Parameter name="OutputFormat" direction="in" type="string" eval="constant">mlXML</Parameter>
		<Parameter name="Normalize" direction="in" type="string" eval="constant">Post</Parameter>
		<Parameter name="InDocument" direction="in" type="document" eval="variable">workDoc</Parameter>
		<Parameter name="OutDocument" direction="out" eval="variable" type="document">outTypeDoc</Parameter>
	</Activity>
	<Activity Name="addExternalPackKey">
		<Action>Translate</Action>
		<Description>Translate for adding external key to document</Description>
		<Execution>SYNCHR</Execution>
		<Parameter name="eventState" direction="in" type="string" eval="constant">TRANSLATE</Parameter>
		<Parameter name="Derived" direction="in" type="string" eval="constant">false</Parameter>
		<Parameter name="Translator" direction="in" type="string" eval="constant">XSLT</Parameter>
		<Parameter name="Map" direction="in" type="string" eval="constant">MDRITME1/maps/addExternalKey.xsl</Parameter>
		<Parameter name="OutputFormat" direction="in" type="string" eval="constant">mlXML</Parameter>
		<Parameter name="Normalize" direction="in" type="string" eval="constant">None</Parameter>
		<Parameter name="InDocument" direction="in" type="document" eval="variable">workDoc</Parameter>
		<Parameter name="OutDocument" direction="out" eval="variable" type="document">dummyDoc</Parameter>
	</Activity>
	<Activity Name="VerifyRecordStatus">
		<Action>VerifyRecordStatus</Action>
		<Description>Check records are already in workflow.</Description>
		<Execution>SYNCHR</Execution>
		<Parameter name="eventState" direction="in" type="string" eval="constant">GETPRODUCTINFO</Parameter>
		<Parameter name="MasterCatalog" direction="in" type="string" eval="constant">ITEM_MASTER</Parameter>
		<Parameter name="InDocument" direction="in" type="document" eval="variable">dummyDoc</Parameter>
		<Parameter name="Agency" direction="in" type="string" eval="constant">SOURCE</Parameter>
		<Parameter name="OutDocument" direction="out" eval="variable" type="document">dummyDoc1</Parameter>
	</Activity>
	<Activity Name="getOriginalMessage">
		<Action>Translate</Action>
		<Description>Translate to get all inbound item ids</Description>
		<Execution>SYNCHR</Execution>
		<Parameter name="Derived" direction="in" type="string" eval="constant">false</Parameter>
		<Parameter name="Map" direction="in" type="string" eval="constant">MDRITME1/maps/MIX/getOriginalMessage_MIX.xsl</Parameter>
		<Parameter name="OutputFormat" direction="in" type="string" eval="constant">XML</Parameter>
		<Parameter name="eventState" direction="in" type="string" eval="constant">TRANSLATE</Parameter>
		<Parameter name="Translator" direction="in" type="string" eval="constant">XSLT</Parameter>
		<Parameter name="InDocument" direction="in" type="document" eval="variable">inDoc</Parameter>
		<Parameter name="OutDocument" direction="out" eval="variable" type="document">HierarchyLinkDoc</Parameter>
	</Activity>
	<Activity Name="SendHierarchyandLinkInfoToJMS">
		<Action>SendProtocolMessage</Action>
		<Description>send InDoc to BW JMS queue to create Hierarchy Information and Link records</Description>
		<Execution>ASYNCHR</Execution>
		<Parameter name="BizProtocol" direction="in" type="string" eval="constant">JMS</Parameter>
		<Parameter name="SupplierCredential" direction="in" type="string" eval="xpath" source="/Message/Header/MessageHeader[@role='Supplier']/Credential[@domain='GLN']/Identity/text()">inDoc</Parameter>
		<Parameter name="SenderCredential" direction="in" type="string" eval="xpath" source="/Message/Header/MessageHeader[@role='Retailer']/Credential[@domain='GLN']/Identity/text()">inDoc</Parameter>
		<Parameter name="ChannelCredential" direction="in" type="string" eval="xpath" source="/Message/Header/MessageHeader[@role='Channel']/Credential[@domain='GLN']/Identity/text()">inDoc</Parameter>
		<Parameter name="ChannelOrganizationName" direction="in" type="string" eval="xpath" source="/Message/Header/MessageHeader[@role='Channel']/Organization/PartyID/PartyName/text()">inDoc</Parameter>
		<Parameter name="PayloadPackagingScheme" direction="in" type="string" eval="constant">HIERARCHYLINK.OPERATION.OUT_1</Parameter>
		<Parameter name="MessageID1" direction="in" type="string" eval="xpath" source="/Message/Body/Document/BusinessDocument/CatalogAction/CatalogActionDetails/CatalogItem[1]/@key">inDoc</Parameter>
		<Parameter name="ExpiryDate" direction="in" type="string" eval="constant">0:1:0:0</Parameter>
		<Parameter name="TrackMessageResponse" direction="in" type="boolean" eval="constant">false</Parameter>
		<Parameter name="eventState" direction="in" type="string" eval="constant">SENDCATALOG</Parameter>
		<Parameter name="ExpiryType" direction="in" type="string" eval="constant">RELATIVE</Parameter>
		<Parameter name="InDocument" direction="in" type="document" eval="variable">HierarchyLinkDoc</Parameter>
	</Activity>
	<Activity Name="SetStatusToError">
		<Action>UpdateEvent</Action>
		<Description>Set the event status to Error/Done</Description>
		<Execution>SYNCHR</Execution>
		<Parameter name="eventStatus" direction="in" type="string" eval="constant">ERROR</Parameter>
		<Parameter name="eventState" direction="in" type="string" eval="constant">DONE</Parameter>
		<Parameter name="errorFlag" direction="in" type="boolean" eval="constant">true</Parameter>
	</Activity>
	<!--CIM Transitions-->
	<Transition FromActivity="AddMsgInfoToAddRecord" ToActivity="ManageRecordCollectionForCICReviewMessage"/>
	<Transition FromActivity="ManageRecordCollectionForCICReviewMessage" ToActivity="GetAllInboundItemIDs1"/>
	<Transition FromActivity="GetAllInboundItemIDs1" ToActivity="ExtractItemIDs1"/>
	<Transition FromActivity="ExtractItemIDs1" ToActivity="GetListofGtinsAndProdTypes"/>
	<Transition FromActivity="GetListofGtinsAndProdTypes" ToActivity="GetCICReviewMessage"/>
	<Transition FromActivity="GetCICReviewMessage" ToActivity="EvaluateRuleBaseContainsForReview"/>
	<Transition FromActivity="EvaluateRuleBaseContainsForReview" ToActivity="ConvertRecordsToOutputFormat1Sync"/>
	<Transition FromActivity="ConvertRecordsToOutputFormat1Sync" ToActivity="IdentifyProtocolOperationsFor1SyncCICReview"/>
	<Transition FromActivity="IdentifyProtocolOperationsFor1SyncCICReview" ToActivity="HandleProtocolMessageFor1syncCICReview"/>
	<Transition FromActivity="HandleProtocolMessageFor1syncCICReview" ToActivity="TranslateActivityToConvertToCICReviewFormat"/>
	<Transition FromActivity="TranslateActivityToConvertToCICReviewFormat" ToActivity="Publish1SyncCICReviewMessage"/>
	<Transition FromActivity="Publish1SyncCICReviewMessage" ToActivity="CheckForMoreMessagesRej"/>
	<Transition FromActivity="GetItemDataForReview" ToActivity="GetAllInboundItemIDs"/>
	<Transition FromActivity="GetAllInboundItemIDs" ToActivity="ExtractItemIDs"/>
	<Transition FromActivity="ExtractItemIDs" ToActivity="ManageRecordCollectionBeforeReject"/>
	<Transition FromActivity="ManageRecordCollectionBeforeReject" ToActivity="FilterRecordsToBeRejected"/>
	<Transition FromActivity="FilterRecordsToBeRejected" ToActivity="ConcatRecordsIDsToBeRejected"/>
	<Transition FromActivity="Getdummy" ToActivity="GetItemData1"/>
	<Transition FromActivity="GetItemData1" ToActivity="ManageRecordCollectionforRejectITEM"/>
	<Transition FromActivity="ManageRecordCollectionforRejectITEM" ToActivity="ExtractRecordKeys"/>
	<Transition FromActivity="ExtractRecordKeys" ToActivity="SetStatusCodeToReview"/>
	<Transition FromActivity="UpdateHierarchyRoleStatus" ToActivity="UpdateHierRoleConfirmed"/>
	<Transition FromActivity="GetTimeStamp" ToActivity="UpdateHierarchyRoleStatus"/>
	<Transition FromActivity="ChangeDocumentType" ToActivity="GetRecordForUpdate"/>
	<Transition FromActivity="GetRecordForUpdate" ToActivity="addExternalPackKey"/>
	<Transition FromActivity="addExternalPackKey" ToActivity="VerifyRecordStatus"/>
	<Transition FromActivity="VerifyRecordStatus" ToActivity="getOriginalMessage"/>
	<Transition FromActivity="getOriginalMessage" ToActivity="SendHierarchyandLinkInfoToJMS"/>
	<Transition FromActivity="SendHierarchyandLinkInfoToJMS" ToActivity="UpdateRecordStateAsReviewed"/>
	<Transition FromActivity="CheckForMoreMessagesRej" ToActivity="HandleProtocolMessageFor1syncCICReview">
		<Description>If we are done, then move to Completion.</Description>
		<Rule>
			<Parameter name="state" type="string" direction="in" eval="variable">nextCmd2</Parameter>
			<Parameter name="inputParamString" type="string" direction="in" eval="constant">Suspend</Parameter>
			<Parameter name="result" type="boolean" direction="out"/>
			<Condition format="java">
				<![CDATA[com.tibco.mdm.workflow.engine.transition.WfSharedConditionTransition.doesNotEqualsIgnoringCase(state, inputParamString);]]>
			</Condition>
		</Rule>
	</Transition>
	<Transition FromActivity="CheckForMoreMessagesRej" ToActivity="GetItemDataForReview"/>
	<Transition FromActivity="ConcatRecordsIDsToBeRejected" ToActivity="Getdummy">
		<Description>if records need to be deleted.</Description>
		<Rule>
			<Parameter name="delconcatRecList" direction="in" eval="variable" type="string">delconcatRecList1</Parameter>
			<Parameter name="inputParamString" type="string" direction="in" eval="constant">dummy</Parameter>
			<Parameter name="result" type="boolean" direction="out"/>
			<Condition format="java">
				<![CDATA[com.tibco.mdm.workflow.engine.transition.WfSharedConditionTransition.doesNotEqualsIgnoringCase(delconcatRecList, inputParamString);]]>
			</Condition>
		</Rule>
	</Transition>
	<Transition FromActivity="ConcatRecordsIDsToBeRejected" ToActivity="UpdateHierarchyRoleStatus"/>
	<Transition FromActivity="SetStatusCodeToReview" ToActivity="GetTimeStamp">
		<Rule>
			<Parameter direction="in" eval="variable" name="isUpdateHierarchyRolesBln" type="boolean" >updateHierarchyRolesBln</Parameter>
			<Parameter direction="in" eval="constant" name="trueBoolean" type="string" >true</Parameter>
			<Parameter direction="out" name="result" type="boolean" />
			<Condition format="bsh" >
				<![CDATA[ result = ((isUpdateHierarchyRolesBln !=null) && (isUpdateHierarchyRolesBln.toString().equalsIgnoreCase(trueBoolean))); ]]>
			</Condition>
		</Rule>
	</Transition>
	<Transition FromActivity="SetStatusCodeToReview" ToActivity="NoOpBeforeUpdatingRecordState"/>
	<Transition FromActivity="NoOpBeforeUpdatingRecordState" ToActivity="UpdateRecordStateUnConfirmed">
	</Transition>
	<Transition FromActivity="NoOpBeforeUpdatingRecordState" ToActivity="ChangeDocumentType"/>
	<Transition FromActivity="UpdateHierRoleConfirmed" ToActivity="UpdateRecordStateUnConfirmed">
		<Rule>
			<Parameter direction="in" eval="variable" name="strIMRecordState" type="string" >ItemMasterRecordState</Parameter>
			<Parameter direction="in" eval="constant" name="strUconfirmed" type="string" >UNCONFIRMED</Parameter>
			<Parameter direction="out" name="result" type="boolean" />
			<Condition format="bsh" >
				<![CDATA[ result = ((strIMRecordState !=null) && (strIMRecordState.equalsIgnoreCase(strUconfirmed))); ]]>
			</Condition>
		</Rule>
	</Transition>
	<Transition FromActivity="UpdateHierRoleConfirmed" ToActivity="ChangeDocumentType">
		<Rule>
			<Parameter name="delconcatRecList" direction="in" eval="variable" type="string">delconcatRecList1</Parameter>
			<Parameter name="inputParamString" type="string" direction="in" eval="constant">dummy</Parameter>
			<Parameter name="result" type="boolean" direction="out"/>
			<Condition format="java">
				<![CDATA[com.tibco.mdm.workflow.engine.transition.WfSharedConditionTransition.doesNotEqualsIgnoringCase(delconcatRecList, inputParamString);]]>
			</Condition>
		</Rule>
	</Transition>
	<Transition type="error" FromActivity="Any" ToActivity="SetStatusToError"/>
</Workflow>
